<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>OJINGEO PROJECT</title>

<link rel="icon" type="image/png" href="favicon.png">
<link rel="apple-touch-icon" href="favicon.png">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
@font-face {
  font-family: "SquidFont";
  src: url("fonts/squid.ttf") format("truetype");
  font-display: swap;
}

* { box-sizing: border-box; font-family: "SquidFont" !important; }

body {
  margin: 0;
  background: #0f0f0f;
  color: #fff;
  text-align: center;
}

/* LOADING */
#loadingScreen {
  position: fixed;
  inset: 0;
  background: #0f0f0f;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 48px;
  z-index: 9999;
  transition: opacity .8s ease;
}

/* HEADER */
header {
  padding: 80px 20px 60px;
  background: radial-gradient(circle at top, #1a1a1a, #000);
  position: relative;
}

header img { width: 300px; margin-bottom: 20px; }

.btn {
  padding: 14px 28px;
  background: #ff3b3b;
  border: none;
  color: #fff;
  cursor: pointer;
  border-radius: 6px;
  margin: 6px;
}

.btn.secondary { background:#222; border:1px solid #444; }

.top-right-buttons {
  position:absolute;
  top:20px;
  right:20px;
  display:flex;
  flex-direction:column;
  gap:10px;
}

/* SECTIONS */
section {
  padding:80px 20px;
  max-width:1000px;
  margin:auto;
}

.hidden {
  display:none;
}

/* CAROUSEL */
.carousel {
  display:flex;
  align-items:center;
  justify-content:center;
  gap:30px;
  margin-top:40px;
}

.arrow {
  font-size:42px;
  background:none;
  border:none;
  color:#ff3b3b;
  cursor:pointer;
}

.card {
  background:#141414;
  border-radius:10px;
  padding:25px;
  width:320px;
  border:1px solid #222;
}

.card img {
  width:100%;
  border-radius:6px;
}

/* GAME MODES */
.game-modes {
  display:flex;
  flex-direction:column;
  gap:20px;
  margin-top:40px;
  text-align:left;
}

/* INPUT */
input {
  padding:12px;
  margin:6px;
  width:260px;
  border-radius:4px;
  border:none;
}

/* PROFILE */
.profile-card img {
  width:120px;
  height:120px;
  object-fit:cover;
  border-radius:50%;
  margin-bottom:10px;
}

/* FOOTER */
footer {
  padding:40px;
  background:#000;
  opacity:.6;
}
</style>
</head>

<body>

<div id="loadingScreen">LOADING…</div>

<header>
  <div class="top-right-buttons">
    <button class="btn secondary" onclick="switchPage('home')">Home</button>
    <button class="btn secondary" onclick="switchPage('manual')">Manual</button>
    <button class="btn secondary" onclick="switchPage('account')">Account</button>
  </div>

  <img src="images/logo.png">
  <p>A non-profit PC fan-game inspired by SQUID GAME.</p>

  <a class="btn" href="https://satoshiteam.itch.io/ojingeo-project" target="_blank">
    Play on itch.io
  </a>
</header>

<!-- HOME -->
<section id="home">
  <h2>Games (Season 1–3)</h2>

  <div class="carousel">
    <button class="arrow" onclick="prevGame()">◀</button>
    <div class="card">
      <img id="gameImg">
      <h3 id="gameTitle"></h3>
      <p id="gameDesc"></p>
    </div>
    <button class="arrow" onclick="nextGame()">▶</button>
  </div>

  <h2 style="margin-top:80px;">Game Modes</h2>
  <div class="game-modes">
    <div class="card"><h3>Frontman Mode</h3></div>
    <div class="card"><h3>Guard Mode</h3></div>
    <div class="card"><h3>Multiplayer Mode</h3></div>
    <div class="card"><h3>Jun-ho Files</h3></div>
  </div>
</section>

<!-- MANUAL -->
<section id="manual" class="hidden">
  <h2>Manual</h2>
  <p>Follow the rules. Fail and you are eliminated.</p>
</section>

<!-- ACCOUNT -->
<section id="account" class="hidden">

  <!-- AUTH -->
  <div id="authUI">
    <h2>Account</h2>
    <input id="email" placeholder="Email">
    <input id="password" type="password" placeholder="Password"><br>
    <button class="btn" onclick="login()">Login</button>

    <hr style="opacity:.2; margin:40px 0;">

    <input id="regEmail" placeholder="Email">
    <input id="regPassword" type="password" placeholder="Password"><br>
    <button class="btn" onclick="register()">Create Account</button>
  </div>

  <!-- PROFILE -->
  <div id="profileUI" class="hidden profile-card">
    <img id="profileAvatar" src="">
    <h3 id="profileName"></h3>
    <p>Progress: <span id="profileProgress">0%</span></p>

    <input id="newUsername" placeholder="New username">
    <input id="newAvatar" type="file"><br>

    <button class="btn" onclick="saveProfile()">Save Profile</button>
    <button class="btn secondary" onclick="deleteProfile()">Delete Profile</button>
    <button class="btn secondary" onclick="logout()">Logout</button>
  </div>

</section>

<footer>© 2026 SATOSHI TEAM</footer>

<script type="module">
import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";

const supabase = createClient(
  "https://wodzqfuxxpewrvqyedqu.supabase.co",
  "sb_publishable_u_LaQ5HSQ1c8QgnFm290uA_wCZ7QphV"
);

window.login = async () => {
  const { error } = await supabase.auth.signInWithPassword({
    email: email.value,
    password: password.value
  });
  if (error) alert(error.message);
  else location.reload();
};

window.register = async () => {
  const { error } = await supabase.auth.signUp({
    email: regEmail.value,
    password: regPassword.value
  });
  if (error) alert(error.message);
  else alert("Check your email to verify.");
};

window.logout = async () => {
  await supabase.auth.signOut();
  location.reload();
};

window.saveProfile = async () => {
  const { data: { user } } = await supabase.auth.getUser();

  let avatarUrl = null;
  if (newAvatar.files.length) {
    const file = newAvatar.files[0];
    const path = `${user.id}/${file.name}`;

    await supabase.storage.from("profiles").upload(path, file, { upsert:true });
    avatarUrl = supabase.storage.from("profiles").getPublicUrl(path).data.publicUrl;
  }

  await supabase.from("profiles").upsert({
    id: user.id,
    username: newUsername.value,
    avatar: avatarUrl,
    progress: "0%"
  });

  location.reload();
};

window.deleteProfile = async () => {
  if (!confirm("Delete profile?")) return;
  const { data:{user} } = await supabase.auth.getUser();
  await supabase.from("profiles").delete().eq("id", user.id);
  await supabase.auth.signOut();
  location.reload();
};

const { data:{session} } = await supabase.auth.getSession();
if (session) {
  authUI.classList.add("hidden");
  profileUI.classList.remove("hidden");

  const { data } = await supabase.from("profiles")
    .select("*").eq("id", session.user.id).single();

  if (data) {
    profileName.textContent = data.username || "Player";
    profileProgress.textContent = data.progress || "0%";
    if (data.avatar) profileAvatar.src = data.avatar;
  }
}
</script>

<script>
function switchPage(id){
  document.querySelectorAll("section").forEach(s=>s.classList.add("hidden"));
  document.getElementById(id).classList.remove("hidden");
}

const games = [
  {img:"images/shot1.png", title:"Red Light, Green Light", desc:"Move at the wrong time & your eliminated!"},
  {img:"images/shot2.png", title:"Dalgona", desc:"Precision or death."},
  {img:"images/shot3.png", title:"Tug of War", desc:"Strength & teamwork."},
  {img:"images/shot4.png", title:"Marbles", desc:"Luck & strategy."},
  {img:"images/shot5.png", title:"Glass Bridge", desc:"One wrong step & your eliminated!"},
  {img:"images/shot6.png", title:"Squid Game", desc:"The final showdown."},
  {img:"images/shot7.png", title:"Pentathalon", desc:"Complete the trials."},
  {img:"images/shot8.png", title:"Mingle", desc:"Find the room."},
  {img:"images/shot9.png", title:"Hide & Seek", desc:"Escape or die..."},
  {img:"images/shot10.png", title:"Jump Rope", desc:"Timing is everything."},
  {img:"images/shot11.png", title:"Sky Squid Game", desc:"High stakes finale."}
];

let i=0;
function renderGame(){
  gameImg.src=games[i].img;
  gameTitle.textContent=games[i].title;
  gameDesc.textContent=games[i].desc;
}
renderGame();
function nextGame(){ i=(i+1)%games.length; renderGame(); }
function prevGame(){ i=(i-1+games.length)%games.length; renderGame(); }

window.onload=()=>{
  loadingScreen.style.opacity=0;
  setTimeout(()=>loadingScreen.remove(),800);
};
</script>

</body>
</html>
